---
title: "カタラン定数と積分"
date: 2025-12-19 06:40:00 +0900
categories: [ブログ]
tags: [数学]
math: true
---

# Catalan's constant
カタラン定数(Catalan's constant)という定数がある。<br>
具体的な式は次のように書き表される。

$$
G:=\sum_{n=0}^\infty \frac{(-1)^n}{(2n+1)^2}
=\frac{1}{1^2}-\frac{1}{3^2}+\frac{1}{5^2}-\frac{1}{7^2}+\cdots
$$

この級数は絶対収束する。値としては次のような値で

$$
G\fallingdotseq  0.915965594177219015054603514932384110774…
$$

今のところ「無理数かどうかさえも知られていない」という奇妙な数である。

え。なんだって、って感じではあるが、それもまた事実だ。

カタラン定数にはたくさんの積分表示が知られている。例えば

$$
\begin{align*}
G&=\int_1^\infty \frac{\ln t}{1+t^2}dt \\
2G&=\int_0^{\pi/2} \frac{t}{\sin t}dt \\
G&=\int_0^1\int_0^1\frac{1}{1+x^2y^2}dxdy
\end{align*}
$$

など、興味がそそられる式がたくさん書いてある。

# 問題の積分

問題となる積分は、Wikipediaに書かれてあった。
少し変形してあるが次の通りである。


$$
\int_1^\infty \frac{(t^4-6t^2+1)\ln(\ln t)}{(1+t^2)^3}dt=\frac{2G}{\pi}
$$

(初めて提示されたのはVictor Adamchikによる"A class of logarithmic integrals"(1997)である：ここではより一般的に結果が述べられている)

さて、どのように証明していけばいいのであろうか。

***

まず、多項式 $t^4-6t^2+1$ について、因数分解できることを注意しておこう。

$$
t^4-6t^2+1=(t^2-1)^2-4t^2=(t^2-2t+1)(t^2+2t+1)
$$

いわゆる複二次式の因数分解と呼ばれるものである。
そしてこの $t^4-6t^2+1$ はもう1つ重要な性質を持つ：

$$
\tan 4\theta
=\frac{2\tan 2\theta}{1-\tan^2(2\theta)}
=\frac{2\left(\frac{2\tan\theta}{1-\tan^2\theta}\right)}{1-\left(\frac{2\tan\theta}{1-\tan^2\theta}\right)^2}
=\frac{4\tan\theta(1-\tan^2\theta)}{\tan^4\theta-6\tan^2\theta+1}
$$

こちらはいわゆる $\tan$ の4倍角を導出したものであるが、この分母に多項式 $t^4-6t^2+1$ が現れている。<br>
(分母を計算するときに $(1-\tan^2\theta)^2-4\tan^2\theta$ を計算している)

しかし実際に $t=\tan\theta$ の置換をすることは今回あまり意味がない。(理由は後述)

## Step1: 部分積分

$$
\frac{d}{dt}\frac{t-t^3}{(1+t^2)^2}=\frac{t^4-6t^2+1}{(1+t^2)^3}
$$

からすぐに導かれる。
以上よりわかったことは

$$
\int_1^\infty \frac{(t^4-6t^2+1)\ln(\ln t)}{(1+t^2)^3}dt
=\int_1^\infty\frac{t^2-1}{(1+t^2)^2\ln t} dt
$$

である。

## Step2: $t=e^x$ という置換

ここでまさかの置換を行うのだが、 $t=e^x$ という置換を行う。
$\ln t$ を綺麗にするため、という理由もあるが、実は他にも理由がある：

$$
\begin{align*}
\int_1^\infty\frac{t^2-1}{(1+t^2)^2\ln t} dt
&=\int_0^\infty\frac{e^{2x}-1}{x(1+e^{2x})^2}e^xdx \\
&=\int_0^\infty\frac{1}{x}\frac{e^x}{1+e^{2x}}\frac{e^{2x}-1}{e^{2x}+1}dx \\
&=\int_0^\infty\frac{1}{2x}\frac{1}{\left(\frac{e^x+e^{-x}}{2}\right)}\frac{e^x-e^{-x}}{e^x+e^{-x}}dx \\
&=\frac{1}{2}\int_0^\infty\frac{\tanh x\cdot\mathrm{sech} x}{x}dx
\end{align*}
$$

このように双曲線関数を用いた式で簡単に書くことができる。
$t=\tan\theta$ よりはこちらの方が使い勝手がいい。

## ところで $t=\tan\theta$ の置換は意味がなかったのか？？

念の為 $t=\tan\theta$ の置換がどうなるか、簡単に述べておく。

$$
\begin{align*}
\int_{1}^\infty \frac{(t^4-6t^2+1)\ln(\ln t)}{(1+t^2)^3}dt
&=\int_{\pi/4}^{\pi/2} \frac{\tan^4\theta-6\tan^2\theta+1}{(1+\tan^2\theta)^3}\cdot\ln(\ln \tan\theta)\frac{d\theta}{\cos^2\theta} \\
&=\int_{\pi/4}^{\pi/2} (\tan^4\theta-6\tan^2\theta+1)\cos^4\theta\cdot\ln(\ln \tan\theta)d\theta \\
&=\int_{\pi/4}^{\pi/2} (\sin^4\theta-6\sin^2\theta\cos^2\theta+\cos^4\theta)\cdot\ln(\ln \tan\theta)d\theta \\
&=\int_{\pi/4}^{\pi/2} \left((\cos^2\theta-\sin^2\theta)^2-4\sin^2\theta\cos^2\theta\right)\cdot\ln(\ln \tan\theta)d\theta \\
&=\int_{\pi/4}^{\pi/2} (\cos^2 2\theta-\sin^2 2\theta)\cdot\ln(\ln \tan\theta)d\theta \\
&=\int_{\pi/4}^{\pi/2} \cos 4\theta\cdot\ln(\ln \tan\theta)d\theta　\quad \text{(ここから部分積分)} \\
&=\left\[\frac{1}{4}\sin 4\theta\cdot\ln(\ln \tan\theta)\right\]_{\pi/4}^{\pi/2}
-\int_{\pi/4}^{\pi/2}\frac{1}{4}\sin 4\theta\cdot (\ln(\ln \tan\theta))' d\theta \\
&=-\frac{1}{4}\int_{\pi/4}^{\pi/2}\sin 4\theta\cdot \frac{1}{\cos^2\theta\cdot\tan\theta\cdot\ln \tan\theta} d\theta \\
&=-\frac{1}{4}\int_{\pi/4}^{\pi/2}\frac{4\sin\theta\cdot\cos\theta\cdot\cos2\theta}{\cos\theta\cdot\sin\theta\cdot\ln \tan\theta} d\theta \\
&=-\int_{\pi/4}^{\pi/2}\frac{\cos2\theta}{\ln \tan\theta} d\theta
\end{align*}
$$

かなり綺麗になった。
しかし、ここで議論が行き詰まってしまう。すなわち

- $\ln \tan\theta$ が分母にあるので部分積分はしたくない
- 結局 $t=\tan\theta$ で置き戻したくなってしまう（置換の意味がなくなってしまう）

双曲線関数が使える $t=e^x$ の置換の方が優れていたというわけだ。

## Step3: 複素積分をしよう

さて、求める積分は

$$
I=\frac{1}{2}\int_0^\infty\frac{\tanh x\cdot\mathrm{sech} x}{x}dx
$$

であったわけで、実はここまで来るともう視界が見えている。
例えば、複素関数と思うことで

$$
\mathrm{Res}\left(\frac{\tanh z\cdot\mathrm{sech} z}{z}\right)_{z=(n+1/2)\pi i}
=(-1)^{n+1}\frac{4i}{(2n+1)^2\pi^2}
$$

などが実際成り立ち、ここからカタラン定数の級数定義に帰着されるだろうという起結を予想するのも難しくはない。<br>
他にもやり方はあるが(いつか書くかも)、今はこのやり方を採用してみよう。<br>
何せ、非常に直感的である！！<br>

まず奇関数性から

$$
I=\frac{1}{4}\int_{-\infty}^\infty\frac{\tanh x\cdot\mathrm{sech} x}{x}dx
$$

と変換しておく。
次に複素関数 $\displaystyle f(z)=\frac{\tanh z\cdot\mathrm{sech} z}{z}=\frac{\sinh z}{z\cosh^2 z}$ を定める。
大事なこととして

- $z\to 0$ の時 $\sinh z\fallingdotseq z$ そして $\cosh z\to 1$ なので $f(z)\to 1$ である(除去可能特異点)

ということに注意しておく。

さて、4点 $-R, R, -R+2N\pi i, R+2N\pi i$ を結んだ長方形を考えて、この長方形の境界に沿って反時計回りに複素積分を行う。
(ただし $R, N>0$ で $N\in \mathbb{N}$ である)

### 下端

ここは簡単で

$$
\int_{-R}^R f(z)dz \to \int_{-\infty}^\infty f(z)dz
$$

が簡単にわかる。これが求める積分 $I$ の4倍になる。

### 上端

さて、積分の向きが「右→左」の向きであることに注意をして

$$
\begin{align*}
\int_{R+2N\pi i}^{-R+2N\pi i} f(z)dz
&=-\int_{-R+2N\pi i}^{R+2N\pi i} \frac{\sinh z}{z\cosh^2 z}dz \\
&=-\int_{-R}^R \frac{\sinh (z+2N\pi i)}{(z+2N\pi i)\cosh^2 (z+2N\pi i)}dz \\
&=-\int_{-R}^R \frac{\sinh z}{(z+2N\pi i)\cosh^2 z}dz \quad \text{($\sinh, \cosh$ 両方とも $2\pi i$ を周期に持つ)} \\
&\to -\int_{-\infty}^\infty \frac{\sinh z}{(z+2N\pi i)\cosh^2 z}dz \quad (R\to \infty)
\end{align*}
$$

がわかる。この積分を $K_N$ とおき、これが $N\to\infty$ の極限でどのように振る舞うかを見る。

$$
\begin{align*}
|K_N|
&=\left|\int_{-\infty}^\infty \frac{\sinh z}{(z+2N\pi i)\cosh^2 z}dz\right| \\
&\le\int_{-\infty}^\infty \frac{|\sinh z|}{|z+2N\pi i|\cosh^2 z}dz \\
&\le\frac{2}{2N\pi}\int_0^\infty \frac{\sinh z}{\cosh^2 z}dz \quad (|z+2N\pi i|\ge 2N\pi) \\
&=\frac{2}{2N\pi}\cdot 2 \to 0 \quad (N\to\infty)
\end{align*}
$$

最後は被積分関数が $-\mathrm{sech}z$ の微分であることを使った。
それはともあれ、上端積分は $0$ に収束するわけである。

### 右端 (なお左端も同様)

今 $z=R+iy$ ($0\le y<2N\pi$) とおく。この時 $f(z)$ の振る舞いがどうなるかを見ていく。

$$
\begin{align*}
|f(z)|
&=\frac{|\tanh z|\cdot|\mathrm{sech}z|}{|z|} \\
&\le\frac{|\mathrm{sech}z|}{R} \quad (|\tanh z|\le 1, |z|\ge R)
\end{align*}
$$

さて $\mathrm{sech}$ については $\displaystyle \mathrm{sech}z = \frac{2}{e^z+e^{-z}}=\frac{2e^{-z}}{1+e^{-2z}}$ と変形可能なことを用いて

$$
|\mathrm{sech}z|
=\frac{2|e^{-(R+iy)}|}{|1+e^{-2(R+iy)}|}
\le\frac{2e^{-R}}{1-e^{-2R}}\le 4e^{-R}
$$

となる(途中で三角不等式及び $1-e^{-2}>1-2^{-2}>0.5$ を用いた)。
これによって一様な不等式

$$
|f(z)| \le \frac{4e^{-R}}{R} \quad (0\le y < 2N\pi)
$$
 
が得られる。このことから右端の積分について

$$
\left|\int_R^{R+2N\pi i}f(z)dz\right|
=\left|\int_0^{2N\pi}f(R+iy)idy\right|
\le 2N\pi \cdot \frac{4e^{-R}}{R}
\to 0 \quad (N\to\infty)
$$

が得られた。

### まとめると

まとめると、 $4I$ と、 $K_N$ と、高々絶対値が $2N\pi \cdot \frac{4e^{-R}}{R}$ くらいの項が2つと、足し合わせた複素積分が留数から決まる値

$$
2\pi i\cdot\sum_{n=0}^{2N-1}(-1)^{n+1}\frac{4i}{(2n+1)^2\pi^2}
$$

と一致する。すなわち $N\to\infty$ の極限をすることで

$$
\begin{align*}
I
&=\frac{1}{4}2\pi i \cdot \sum_{n=0}^\infty(-1)^{n+1}\frac{4i}{(2n+1)^2\pi^2} \\
&=\frac{2}{\pi}\sum_{n=0}^\infty\frac{(-1)^n}{(2n+1)^2}
=\frac{2G}{\pi}
\end{align*}
$$

と定まるということになる。

# 感想

けっこう大変なように見えて意外とそうでもない。
複素積分のところは丁寧に書いていただけで、実際はそんなに複雑なこともしてない。
